Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Nothing to solve"; StatusIsError = 0
"Test 1: ? on variable with value returns 1"

y: 5
y?-> 1
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Nothing to solve"; StatusIsError = 0
"Test 2: ? on declared but empty variable returns 0"

y:
y?-> 0
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Nothing to solve"; StatusIsError = 0
"Test 3: if(y?; y; default) with empty y uses default"

y:
z: if(y?; y; 4)
z-> 4
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Nothing to solve"; StatusIsError = 0
"Test 4: if(y?; y; default) with y=5 uses y"

y: 5
z: if(y?; y; 4)
z-> 5
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Nothing to solve"; StatusIsError = 0
"Test 5: Pre-solve fallback - z~ keeps its previous output value"

y:
z: if(y?; y; z~)
z-> 35
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Solved with errors: Line 3: Cannot evaluate \"if(y2?; y2; 4)\" - Undefined variable: y2"; StatusIsError = 1
"Test 6: Undeclared variable errors"

z: if(y2?; y2; 4)
z->
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Nothing to solve"; StatusIsError = 0
"Test 7: Solve counter using ~ pre-solve fallback"

numSolves: numSolves~ + 1
numSolves-> 1
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Nothing to solve"; StatusIsError = 0
"Count number of solves using ~? and ~"

solveCount: if(solveCount~?; solveCount~ + 1; 1)
solveCount=> 1 Use => to persist across clears
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Solved with errors: Line 4: Cannot evaluate \"y~\" - Variable 'y' has no value"; StatusIsError = 1
"Test 9: x~ on variable with no stale value errors"

y:
z: y~
z->
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Solved with errors: Line 3: Cannot evaluate \"if(abc~?; 1; 2)\" - Undefined variable: abc"; StatusIsError = 1
"Test 10: x~? on undefined variable errors"

z: if(abc~?; 1; 2) "abc is undefined"
z->
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Category = "Unfiled"; Secret = 0
Places = 4; StripZeros = 1
Format = "float"; GroupDigits = 0; DegreesMode = 0; ShadowConstants = 0
Status = "Solved with errors: Line 3: Variable 'w' has no value to output"; StatusIsError = 1
"Test 11: x? no longer sees stale values"

w->
r: w?
r-> 0
~~~~~~~~~~~~~~~~~~~~~~~~~~~